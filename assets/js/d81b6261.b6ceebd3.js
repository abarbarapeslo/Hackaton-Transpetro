"use strict";(self.webpackChunkhackathon_transpetro=self.webpackChunkhackathon_transpetro||[]).push([[825],{4591:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>o,contentTitle:()=>r,default:()=>x,frontMatter:()=>d,metadata:()=>n,toc:()=>a});const n=JSON.parse('{"id":"implementacao_tecnica/banco_de_dados","title":"Arquitetura de Dados \u2014 Servi\xe7o de Previs\xe3o de Bioincrusta\xe7\xe3o","description":"Vis\xe3o Geral","source":"@site/docs/implementacao_tecnica/banco_de_dados.md","sourceDirName":"implementacao_tecnica","slug":"/implementacao_tecnica/banco_de_dados","permalink":"/Hackaton-Transpetro/implementacao_tecnica/banco_de_dados","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":0,"frontMatter":{"sidebar_position":0,"title":"Arquitetura de Dados \u2014 Servi\xe7o de Previs\xe3o de Bioincrusta\xe7\xe3o"},"sidebar":"defaultSidebar","previous":{"title":"Implementa\xe7\xe3o T\xe9cnica","permalink":"/Hackaton-Transpetro/category/implementa\xe7\xe3o-t\xe9cnica"},"next":{"title":"Plano de Infraestrutura","permalink":"/Hackaton-Transpetro/implementacao_tecnica/infraestrutura"}}');var l=s(4848),i=s(8453);const d={sidebar_position:0,title:"Arquitetura de Dados \u2014 Servi\xe7o de Previs\xe3o de Bioincrusta\xe7\xe3o"},r=void 0,o={},a=[{value:"Vis\xe3o Geral",id:"vis\xe3o-geral",level:2},{value:"1. Componentes centrais de persist\xeancia",id:"1-componentes-centrais-de-persist\xeancia",level:2},{value:"2. Modelagem de Dados (Schemas FastAPI / Pydantic)",id:"2-modelagem-de-dados-schemas-fastapi--pydantic",level:2},{value:"A. Entrada (IN) \u2014 <code>InputFeatures</code>",id:"a-entrada-in--inputfeatures",level:3},{value:"B. Sa\xedda (OUT) \u2014 <code>PredictionOutput</code>",id:"b-sa\xedda-out--predictionoutput",level:3}];function c(e){const t={blockquote:"blockquote",code:"code",em:"em",h2:"h2",h3:"h3",hr:"hr",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(t.h2,{id:"vis\xe3o-geral",children:"Vis\xe3o Geral"}),"\n",(0,l.jsxs)(t.p,{children:["\u2003Este documento descreve a ",(0,l.jsx)(t.strong,{children:"arquitetura de dados"})," do microservi\xe7o de ",(0,l.jsx)(t.strong,{children:"Previs\xe3o de Bioincrusta\xe7\xe3o"})," (Nautilus). O padr\xe3o adotado \xe9 ",(0,l.jsx)(t.strong,{children:"Model-First Service Architecture"}),": o ativo central \xe9 o modelo de Machine Learning pr\xe9-treinado, e o servi\xe7o \xe9 essencialmente ",(0,l.jsx)(t.em,{children:"stateless"}),", respons\xe1vel por carregar o modelo, executar infer\xeancias e expor APIs de predi\xe7\xe3o."]}),"\n",(0,l.jsx)(t.p,{children:"\u2003O objetivo aqui \xe9 documentar onde os artefatos s\xe3o persistidos, quais esquemas (Pydantic/FastAPI) comp\xf5em a I/O do servi\xe7o, como logs e m\xe9tricas devem ser coletados, e quais camadas de cache e observability devem ser usadas em produ\xe7\xe3o."}),"\n",(0,l.jsx)(t.hr,{}),"\n",(0,l.jsx)(t.h2,{id:"1-componentes-centrais-de-persist\xeancia",children:"1. Componentes centrais de persist\xeancia"}),"\n",(0,l.jsxs)(t.blockquote,{children:["\n",(0,l.jsxs)(t.p,{children:["Neste servi\xe7o, o ",(0,l.jsx)(t.strong,{children:"modelo ML"})," \xe9 a principal pe\xe7a de dados. Bancos relacionais e outros reposit\xf3rios tradicionais aparecem apenas como apoio (logs, armazenamento de dados de treino, snapshots), n\xe3o como fonte prim\xe1ria do runtime de predi\xe7\xf5es."]}),"\n"]}),"\n",(0,l.jsxs)(t.table,{children:[(0,l.jsx)(t.thead,{children:(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.th,{style:{textAlign:"left"},children:"Ativo"}),(0,l.jsx)(t.th,{style:{textAlign:"left"},children:"Tipo de Persist\xeancia"}),(0,l.jsx)(t.th,{style:{textAlign:"left"},children:"Prop\xf3sito"}),(0,l.jsx)(t.th,{style:{textAlign:"left"},children:"Localiza\xe7\xe3o (ex.: GCP)"})]})}),(0,l.jsxs)(t.tbody,{children:[(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.strong,{children:"MODELO ML"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Arquivo bin\xe1rio (.pkl, .joblib, .onnx)"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"\xdanica fonte de verdade do algoritmo de infer\xeancia. Carregado em mem\xf3ria no boot do servi\xe7o."}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Google Cloud Storage (GCS) ou disco da VM (mount do bucket)"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.strong,{children:"DADOS HIST\xd3RICOS"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"CSV / Parquet"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Dataset para treino / re-treino e an\xe1lises off-line."}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Google Cloud Storage (GCS)"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.strong,{children:"SNAPSHOTS I/O (opcional)"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Parquet / JSONL"}),(0,l.jsxs)(t.td,{style:{textAlign:"left"},children:["Arquivamento de entradas e sa\xeddas para monitoramento de ",(0,l.jsx)(t.em,{children:"data drift"})," e auditoria"]}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Firestore / BigQuery"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.strong,{children:"ARQUIVOS DE CONFIG"})}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"YAML / JSON"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Hiperpar\xe2metros, thresholds e vers\xe3o do modelo"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"GCS / Config Store (Secret Manager para segredos)"})]})]})]}),"\n",(0,l.jsxs)(t.p,{children:[(0,l.jsx)(t.strong,{children:"Observa\xe7\xe3o:"})," o servi\xe7o ",(0,l.jsx)(t.strong,{children:"n\xe3o"})," persiste estado transacional (usu\xe1rios, contas, transa\xe7\xf5es) \u2014 ele \xe9 ",(0,l.jsx)(t.em,{children:"stateless"})," e desenhado apenas para c\xe1lculo/infer\xeancia."]}),"\n",(0,l.jsx)(t.hr,{}),"\n",(0,l.jsx)(t.h2,{id:"2-modelagem-de-dados-schemas-fastapi--pydantic",children:"2. Modelagem de Dados (Schemas FastAPI / Pydantic)"}),"\n",(0,l.jsx)(t.p,{children:"\u2003A interface do servi\xe7o \xe9 definida por modelos Pydantic que garantem valida\xe7\xe3o autom\xe1tica, documenta\xe7\xe3o OpenAPI e tipagem clara."}),"\n",(0,l.jsxs)(t.h3,{id:"a-entrada-in--inputfeatures",children:["A. Entrada (IN) \u2014 ",(0,l.jsx)(t.code,{children:"InputFeatures"})]}),"\n",(0,l.jsx)(t.p,{children:"Corpo da requisi\xe7\xe3o POST representando o estado atual da embarca\xe7\xe3o."}),"\n",(0,l.jsxs)(t.table,{children:[(0,l.jsx)(t.thead,{children:(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.th,{style:{textAlign:"left"},children:"Campo"}),(0,l.jsx)(t.th,{style:{textAlign:"center"},children:"Tipo"}),(0,l.jsx)(t.th,{style:{textAlign:"left"},children:"Descri\xe7\xe3o"}),(0,l.jsx)(t.th,{style:{textAlign:"left"},children:"Exemplo"})]})}),(0,l.jsxs)(t.tbody,{children:[(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"distance"})}),(0,l.jsx)(t.td,{style:{textAlign:"center"},children:"float"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Milhas navegadas no per\xedodo"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"40.0"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"duration"})}),(0,l.jsx)(t.td,{style:{textAlign:"center"},children:"float"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Dura\xe7\xe3o da viagem (dias)"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"1.0"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"dias_desde_docagem"})}),(0,l.jsx)(t.td,{style:{textAlign:"center"},children:"int"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Dias desde a \xfaltima docagem"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"280"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"dias_parado_acumulado"})}),(0,l.jsx)(t.td,{style:{textAlign:"center"},children:"float"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Tempo inativo acumulado (dias)"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"20.0"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"velocidade_media"})}),(0,l.jsx)(t.td,{style:{textAlign:"center"},children:"float"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Velocidade m\xe9dia (n\xf3s)"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"11.8"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"consumo_total"})}),(0,l.jsx)(t.td,{style:{textAlign:"center"},children:"float"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Consumo total naquele per\xedodo"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"250.0"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"consumo_por_milha"})}),(0,l.jsx)(t.td,{style:{textAlign:"center"},children:"float"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Consumo por milha"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"6.25"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"draft_medio"})}),(0,l.jsx)(t.td,{style:{textAlign:"center"},children:"float"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Calado m\xe9dio"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"7.3"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"draft_ratio"})}),(0,l.jsx)(t.td,{style:{textAlign:"center"},children:"float"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Raz\xe3o de calado"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"0.85"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"consumo_medio_30d"})}),(0,l.jsx)(t.td,{style:{textAlign:"center"},children:"float"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Consumo m\xe9dio \xfaltimos 30 dias"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"240.1"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"distancia_90d"})}),(0,l.jsx)(t.td,{style:{textAlign:"center"},children:"float/int"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Dist\xe2ncia acumulada 90 dias"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"2340"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"ano"})}),(0,l.jsx)(t.td,{style:{textAlign:"center"},children:"int"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Ano de in\xedcio da simula\xe7\xe3o"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"2025"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"mes"})}),(0,l.jsx)(t.td,{style:{textAlign:"center"},children:"int"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"M\xeas (1\u201312)"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"11"})]}),(0,l.jsxs)(t.tr,{children:[(0,l.jsx)(t.td,{style:{textAlign:"left"},children:(0,l.jsx)(t.code,{children:"trimestre"})}),(0,l.jsx)(t.td,{style:{textAlign:"center"},children:"int"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"Trimestre (1\u20134)"}),(0,l.jsx)(t.td,{style:{textAlign:"left"},children:"4"})]})]})]}),"\n",(0,l.jsxs)(t.blockquote,{children:["\n",(0,l.jsxs)(t.p,{children:["Implementa\xe7\xe3o: ",(0,l.jsx)(t.code,{children:"class InputFeatures(BaseModel): ..."})," em ",(0,l.jsx)(t.code,{children:"app/schemas/bioincrustacao.py"}),"."]}),"\n"]}),"\n",(0,l.jsx)(t.hr,{}),"\n",(0,l.jsxs)(t.h3,{id:"b-sa\xedda-out--predictionoutput",children:["B. Sa\xedda (OUT) \u2014 ",(0,l.jsx)(t.code,{children:"PredictionOutput"})]}),"\n",(0,l.jsxs)(t.p,{children:["Objeto raiz retornado pela API contendo o resumo (",(0,l.jsx)(t.code,{children:"dia_limpeza_recomendado"}),") e a lista de previs\xf5es di\xe1rias (",(0,l.jsx)(t.code,{children:"previsoes"}),", 60 registros)."]}),"\n",(0,l.jsx)(t.p,{children:(0,l.jsx)(t.strong,{children:"Estrutura m\xednima:"})}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-json",children:'{\n  "dia_limpeza_recomendado": { /* RecommendationDetail ou null */ },\n  "previsoes": [ /* PredictionRecord[60] */ ]\n}\n'})})]})}function x(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,l.jsx)(t,{...e,children:(0,l.jsx)(c,{...e})}):c(e)}},8453:(e,t,s)=>{s.d(t,{R:()=>d,x:()=>r});var n=s(6540);const l={},i=n.createContext(l);function d(e){const t=n.useContext(i);return n.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:d(e.components),n.createElement(i.Provider,{value:t},e.children)}}}]);